# SQL_Portofolio

# Steve's Car Showroom
Steve runs a top-end car showroom but his data analyst has just quit and left him without his crucial insights.

1. What are the details of all cars purchased in the year 2022?
   SELECT car_id FROM sales
   WHERE purchase_date = "2022"


2. What is the total number of cars sold by each salesperson?
   SELECT sp.salesman_id, sp.name, COUNT(s.car_id) AS total_cars_sold
   FROM salespersons sp
   LEFT JOIN sales s ON sp.salesman_id = s.salesman_id
   GROUP BY sp.salesman_id, sp.name;

3. What is the total revenue generated by each salesperson?
   SELECT sp.salesman_id, sp.name, SUM (s.car_id) AS total_revenue
   FROM salespersons sp
   JOIN sales s ON sp.salesman_id = s.salesman_id
   JOIN cars c ON s.car_id = c.car_id
   GROUP BY sp.salesman_id, sp.name;


4. What are the details of the cars sold by each salesperson?
   SELECT 
     s.salesman_id,
     sp.name AS salesperson_name,
     c.make,
     c.type,
     c.style,
     c.cost_$
   FROM 
     sales s
   JOIN 
     cars c ON s.car_id = c.car_id
   JOIN 
     salespersons sp ON s.salesman_id = sp.salesman_id
   ORDER BY 
     s.salesman_id;


5. What is the total revenue generated by each car type?
    SELECT 
      type,
      SUM(cost_$) AS total_revenue 
    FROM 
      cars
    GROUP BY 
      type;


6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
   SELECT 
     c.make,
     c.type,
     c.style,
     c.cost_$,
     s.purchase_date
   FROM 
     cars c
   JOIN 
     sales s ON c.car_id = s.car_id
   JOIN 
     salespersons sp ON s.salesman_id = sp.salesman_id
   WHERE 
     sp.name = 'Emily Wong' AND s.purchase_date BETWEEN '2021-01-01' AND '2021-12-31';


7. What is the total revenue generated by the sales of hatchback cars?
   SELECT 
     SUM(cost_$) AS total_revenue_hatchback
   FROM 
     cars
   WHERE 
     type = 'Hatchback';


8. What is the total revenue generated by the sales of SUV cars in the year 2022?
     SELECT 
        SUM(c.cost_$) AS total_revenue_suv
     FROM 
        cars c
     JOIN 
        sales s ON c.car_id = s.car_id
     WHERE 
        c.type = 'SUV' AND s.purchase_date BETWEEN '2022-01-01' AND '2022-12-31';


9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?
   SELECT sp.name, sp.city
   FROM salespersons sp
   JOIN sales s ON sp.salesman_id = s.salesman_id
   WHERE YEAR(s.purchase_date) = 2023
   GROUP BY sp.salesman_id, sp.name, sp.city
   ORDER BY COUNT(s.car_id) DESC
   LIMIT 1;


10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?
    SELECT sp.name, sp.age
    FROM salespersons sp
    JOIN (
      SELECT sp.salesman_id, sp.name, SUM (s.car_id) AS total_revenue
      FROM salespersons sp
      JOIN sales s ON sp.salesman_id = s.salesman_id
      JOIN cars c ON s.car_id = c.car_id
      WHERE YEAR(s.purchase_date) = 2022
      GROUP BY sp.salesman_id, sp.name
      ORDER BY total_revenue DESC
      LIMIT 1
 ) AS t
   ON sp.salesman_id = t.salesman_id;

    
